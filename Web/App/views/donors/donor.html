<div class="page-header" data-bind="visible: !donor().isEditing()">
    <h1>
        <a href='/#donors' class="btn btn-small btn-info" style="display: inline"><i class="icon-arrow-left"></i></a>
        <span data-bind="text: donor().name()"></span>
        <button id="addContactButton" class="btn btn-small btn-info pull-right" data-bind="click: addContact">New Contact</button>
        <button id="addPhoneButton" class="btn btn-small btn-info pull-right" data-bind="click: addPhone" style="margin-right: 5px;">New Phone</button>
        <button id="editButton" class="btn btn-primary btn-small pull-right" data-bind="click: editDonor" style="margin-right: 5px;">Edit Donor</button>
    </h1>
</div>
<div class="page-header" data-bind="visible: donor().isEditing()">
    <input type="text" class="input-large span3" placeholder="Donor Name" data-bind="value: donor().name()" />
    <button id="saveButton" class="btn btn-small btn-primary pull-right" data-bind="click: saveDonor" style="margin-left: 5px;">Save</button>
    <button id="cancelButton" class="btn btn-small btn-primary pull-right" data-bind="click: rollbackDonor">Cancel</button>
</div>

<i class="icon-spinner icon-2x icon-spin active" data-bind="visible: isWorking"></i>

<div id="leftColumn" class="span8 pull-left">

    <div id="donorAddress" data-bind="with: donor().primaryAddress()" class="pull-left" style="margin-right: 10px;">
        <address>
            <span data-bind="text: streetAddress"></span>
            <br />
            <!-- ko if: hasStreet2 -->
            <span data-bind="text: streetAddress2"></span>
            <br />
            <!-- /ko -->
            <span data-bind="text: city"></span>, <span data-bind="    text: state"></span>&nbsp;&nbsp;<span data-bind="    text: zip"></span><br />
        </address>
    </div>

    <div id="donorEmails" class="pull-left" style="margin-left: 10px; margin-right: 10px;">
        <address>
            <a data-bind="attr: { href: 'mailto:' + donor().emailAddress() }">
                <span data-bind="text: donor().emailAddress"></span>
            </a>
        </address>
    </div>

    <div id="donorPhones2" class="pull-left" style="margin-left: 10px;">
        <!-- ko foreach: donor().phones() -->
        <div>
            <span data-bind="text: phoneType().name()" />:&nbsp(<span data-bind="    text: areaCode"></span>)&nbsp<span data-bind="    text: number"></span>
        </div>
        <!-- /ko -->
    </div>

    <div id="donorPhone" style="width: 45%;" data-bind="if: donor().isEditing">
        <table class="st-table table table-condensed table-striped" id="phones">
            <thead>
                <tr>
                    <th class="always not-selectable" style="text-align: left;">Phone Type</th>
                    <th class="always" style="text-align: left;">Phone Number</th>
                    <th class="always" style="text-align: left">Actions</th>
                </tr>
            </thead>
            <tbody data-bind="foreach: donor().phones()">
                <tr>
                    <td class="always" style="text-align: left;">
                        <!-- ko if: isEditing -->
                        <select data-bind="options: $root.phoneTypes, optionsText: 'name', value: phoneType, optionsCaption: 'Choose...'"></select>&nbsp
                    <!-- /ko -->
                        <!-- ko ifnot: isEditing -->
                        <span data-bind="text: phoneType().name()" />
                        <!-- /ko -->
                    </td>
                    <td class="always" style="text-align: left;">
                        <!-- ko if: isEditing -->
                        <input type="text" class="input-small span1" placeholder="Area Code" data-bind="value: areaCode" style="width: 50px;" />&nbsp
                        <input type="text" class="input-small span3" placeholder="Number" data-bind="value: number" />
                        <!-- /ko -->
                        <!-- ko ifnot: isEditing -->
                        (<span data-bind="text: areaCode"></span>)&nbsp<span data-bind="    text: number"></span>
                        <!-- /ko -->
                    </td>
                    <td class="always" style="text-align: left;">
                        <!-- ko ifnot: isEditing -->
                        <button id="editPhoneButton" class="btn btn-mini btn-info" data-bind="click: $root.editPhone">Edit</button>
                        <button id="deletePhoneButton" class="btn btn-mini btn-info" data-bind="click: $root.deletePhone">Delete</button>
                        <!-- /ko -->
                        <!-- ko if: isEditing -->
                        <button id="savePhoneButton" class="btn btn-mini btn-primary" data-bind="click: $root.savePhone">Save</button>
                        <button id="rollbackPhoneButton" class="btn btn-mini btn-inverse" data-bind="click: $root.rollbackPhone">Cancel</button>
                        <!-- /ko -->
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="clearfix" />

    <div id="donorContacts">

        <div class="section-header" style="border-bottom: 0px;">
            <h4>Contacts</h4>
        </div>

        <table class="st-table table table-condensed table-striped" id="contacts">
            <!--<thead>
                <tr>
                    <th class="always not-selectable" style="text-align: left;">Name</th>
                    <th class="always not-selectable" style="text-align: left;">Contact Type</th>
                    <th class="always" style="text-align: left;">Primary</th>
                    <th class="always" style="text-align: left">Email</th>
                    <th class="always" style="text-align: left">Primary Phone</th>
                </tr>
            </thead>-->
            <tbody data-bind="foreach: donor().contacts()">
                <tr>
                    <td class="always" style="text-align: left;">
                        <!-- ko if: isEditing -->
                        <input type="text" class="input-small span3" placeholder="First Name" data-bind="value: firstName" />
                        <input type="text" class="input-small span3" placeholder="Last Name" data-bind="value: lastName" />
                        <!-- /ko -->
                        <!-- ko ifnot: isEditing -->
                        <a href="#" data-bind="attr: { href: '/#contacts/' + id() }">
                            <span data-bind="text: fullName"></span>
                        </a>
                        <!-- /ko -->
                    </td>
                    <td class="always" style="text-align: left;">
                        <!-- ko if: isEditing -->
                        <select data-bind="options: $root.contactTypes, optionsText: 'name', value: contactType, optionsCaption: 'Choose...'"></select>&nbsp
                        <!-- /ko -->
                        <!-- ko ifnot: isEditing -->
                        <span data-bind="text: contactType().name()" />
                        <!-- /ko -->
                    </td>
                    <td class="always" style="text-align: left;">
                        <!-- ko if: isEditing -->
                        <input type="checkbox" data-bind="checked: isPrimary" />
                        <!-- /ko -->
                        <!-- ko ifnot: isEditing -->
                        <span data-bind="visible: isPrimary">Primary</span>
                        <!-- /ko -->
                    </td>
                    <td class="always" style="text-align: left;">
                        <!-- ko if: isEditing -->
                        <input type="text" class="input-small span1" placeholder="Email Address" data-bind="value: emailBusiness" />
                        <!-- /ko -->
                        <!-- ko ifnot: isEditing -->
                        <a data-bind="attr: { href: 'mailto:' + emailBusiness() }">
                            <span data-bind="text: emailBusiness" />
                        </a>

                        <!-- /ko -->
                    </td>
                    <td class="always" style="text-align: left;">
                        <!-- ko if: isEditing -->
                        <input type="text" class="input-small span1" placeholder="Area Code" data-bind="value: primaryPhone().areaCode" style="width: 50px;" />&nbsp
                            <input type="text" class="input-small span3" placeholder="Number" data-bind="value: primaryPhone().number" />
                        <!-- /ko -->
                        <!-- ko ifnot: isEditing -->
                        (<span data-bind="text: primaryPhone().areaCode"></span>)&nbsp<span data-bind="    text: primaryPhone().number"></span>
                        <!-- /ko -->
                    </td>
                    <td class="always" style="text-align: left;">
                        <!-- ko ifnot: isEditing -->
                        <button id="editContactButton" class="btn btn-mini btn-info" data-bind="click: $root.editContact">Edit</button>
                        <button id="deleteContactButton" class="btn btn-mini btn-info" data-bind="click: $root.deleteContact">Delete</button>
                        <!-- /ko -->
                        <!-- ko if: isEditing -->
                        <button id="saveContactButton" class="btn btn-mini btn-primary" data-bind="click: $root.saveContact">Save</button>
                        <button id="cancelContactButton" class="btn btn-mini btn-inverse" data-bind="click: $root.rollbackContact">Cancel</button>
                        <!-- /ko -->
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div id="donorNotes">
        <div class="section-header">
            <h4>Notes
                <button class="btn btn-mini btn-info pull-right" title="Save Notes" data-bind="click: saveNotes"><i class="icon-save"></i></button>
            </h4>
        </div>

        <textarea rows="8" style="width: 100%" data-bind="value: donor().notes" />
    </div>
</div>

<div id="rightColumn" class="span6 pull-left" style="margin-left: 10px;">
    <div class="section-header">
        <h4>Activities
            <button class="btn btn-info btn-mini pull-right" title="Add Activity" data-bind="click: addActivity"><i class="icon-plus"></i></button>
        </h4>
    </div>
    <div id="donorActivities">

        <ul data-bind="foreach: donor().activities()" class="list-unstyled">
            <li>
                <div class="activity">
                    <div class="activity-existing" data-bind="ifnot: isEditing">
                        <strong><span data-bind="text: activityType().name()" style="vertical-align: top"></span></strong>
                        <span data-bind="text: moment(activityDate()).format('M/D/YYYY')" class="comment-date"></span><br />
                        <span data-bind="text: subject" style="vertical-align: top"></span>
                        <span data-bind="text: body" style="vertical-align: top"></span>
                        <div class="clearfix"></div>
                    </div>
                    <div class="activity-editing" data-bind="if: isEditing">
                        <select data-bind="options: $root.activityTypes, optionsText: 'name', value: activityType, optionsCaption: 'Choose...'"></select>
                        <input type="text" class="span2" data-bind="datepicker: activityDate, datepickerOptions: { format: 'M/D/YYYY' }">
                        <select data-bind="options: $root.donor().contacts, optionsText: 'fullName', value: contact, optionsCaption: 'Optional Contact'"></select>
                        <button class="btn btn-mini btn-info pull-right" title="Save Notes" data-bind="click: $root.saveActivity"><i class="icon-save"></i></button><br />
                        <input type="text" data-bind="text: subject" style="width:100%" placeholder="Subject"/>
                        <textarea data-bind="value: body" rows="3" style="width:100%;" placeholder="Body" />
                    </div>
                </div>
            </li>
        </ul>

    </div>
</div>
